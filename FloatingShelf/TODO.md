# FloatingShelf - やり残しリスト

## 🔍 Quick Look トグル問題

### 問題の概要
スペースキーでQuick Lookを表示することはできるが、2回目のスペースキーでQuick Lookを閉じることができない。

### 原因
Quick Lookパネル(`QLPreviewPanel`)が表示されると、別のウィンドウにフォーカスが移動し、2回目のスペースキーがFloatingShelfアプリに届かない。

### 試みた解決策

1. **ShelfWindow.sendEvent()オーバーライド**
   - スペースキーをNSCollectionViewより先にインターセプト
   - 結果: 1回目は動作するが、2回目が届かない

2. **ローカルイベントモニター**
   - アプリ内のキーイベントを監視
   - 結果: Quick Look表示後にアプリがフォーカスを失うため効果なし

3. **グローバルイベントモニター**
   - システム全体のキーイベントを監視
   - 結果: アクセシビリティ権限が必要で、動作が不安定

4. **ローカル+グローバル両方のモニター**
   - 結果: それでも2回目のスペースが効かない

### 将来の解決案
1. QLPreviewPanelのサブクラス化
2. ESCキーでの終了のみに制限
3. カスタムプレビューウィンドウの実装

---

## 🎨 カラーボタンの問題

### 問題
シェルフ右上のカラーボタンをクリックしてもカラーパレットが表示されない。

### 試みた解決策
1. NSButtonからNSView + NSClickGestureRecognizerに変更
2. z-orderを変更（最後に追加で最前面に）
3. ボタンサイズを24x24に拡大

### 状態
まだ解決していない

---

*最終更新: 2024-12-29*
